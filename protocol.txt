# add to all
<?xml version="1.0"?>

# Get auth mechanisms




request
<open xmlns="urn:ietf:params:xml:ns:xmpp-framing" to="localhost" version="1.0" />
<auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='PLAIN'>AHRlc3QAdGVzdHVzZXI=</auth>
<stream:stream from='test@localhost' to='localhost' version='1.0' xml:lang='en' xmlns='jabber:client' xmlns:stream='http://etherx.jabber.org/streams'>
<stream:stream from='test@localhost' to='localhost' version='1.0' xml:lang='en' xmlns='jabber:client' xmlns:stream='http://etherx.jabber.org/streams'>


response
<stream:features xmlns:stream='http://etherx.jabber.org/streams'>
    <mechanisms xmlns='urn:ietf:params:xml:ns:xmpp-sasl'>
        <mechanism>DIGEST-MD5</mechanism>
        <mechanism>PLAIN</mechanism>
        <mechanism>SCRAM-SHA-1</mechanism>
        <mechanism>X-OAUTH2</mechanism>
    </mechanisms>
    <register xmlns='http://jabber.org/features/iq-register'/>
</stream:features>

# Auth PLAN

request
<auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='PLAIN'>AHRlc3QAdGVzdHVzZXI=</auth>

response
<success xmlns='urn:ietf:params:xml:ns:xmpp-sasl'/>


# stream
<stream:stream xmlns='jabber:client' xmlns:stream='http://etherx.jabber.org/streams' to='localhost' version='1.0'>


# Auth with DIGEST-MD5
request
<auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='DIGEST-MD5'/>

response
<challenge xmlns='urn:ietf:params:xml:ns:xmpp-sasl'>bm9uY2U9IjE3MjA3NTE2NzY4NzYzNTQyOTc2Iixxb3A9ImF1dGgiLGNoYXJzZXQ9dXRmLTgsYWxnb3JpdGhtPW1kNS1zZXNz</challenge>

Base64 Decode
nonce="17207516768763542976",qop="auth",charset=utf-8,algorithm=md5-sess=

<auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='PLAIN'>AEphbWVzAGV5SmhiR2NpT2lKU1V6STFOaUlzSW5SNWNDSTZJa3BYVkNKOS5leUpwWVhRaU9qRTFNalkzT0RVMk56UXNJbVY0Y0NJNk1UVXlOamM0TnpRM05Dd2lhWE56SWpvaVRXRndRWEJ3SWl3aWMzVmlJam9pU21GdFpYTWlmUS5leENwS25Na0J5WldobnBfbzFwSDN6R2tHTGNEdjZSZTVIbjZRV3NMeURuS0VGT2ZoZGlzajY0S0pXRDRWUVF5WmJrejNvcGRfaTU5TXE3WlY4WmhkRFF1a2xfUjFCMmdXYl80S2hOVmk3dW5ublFhWTBMUTZXQ0R4OGhUbEQwOTgybjRKVEJndW1UbGt4TFY3U1FkSkt0ejhyMWFQaUpIcmdQOFJsM2ttVUN3N3dYaVRCVS1rY0dUcWEzcDZsa0pQT1lFMWlHYkN2UVFZWUU1eEI2Y3RhUzZ6dGRhcm4yZDlFS2FacXprNkhubExBZnctV0R5OThCVnc0cjRwR3RpNWo1U2RPQ21GUGxPdnROUnZxTnFRV2pycW9QOGsxLTRIUGRaMTh2RlFHelBlUFczZW96Slpva1lGQ2NoTFI3WEh3LTI3SzBMNjJ3M3NBSUg5S1R4U3c=</auth>"


request
<auth mechanism="PLAIN" xmlns="urn:ietf:params:xml:ns:xmpp-sasl">*REDACTED*</auth> 

response
<failure xmlns='urn:ietf:params:xml:ns:xmpp-sasl'><bad-protocol/><text xml:lang='en'>Response decoding failed</text></failure>

<?xml version="1.0"?><stream:stream to="localhost" xml:lang="en" version="1.0" xmlns="jabber:client" xmlns:stream="http://etherx.jabber.org/streams">

<stream:stream xmlns="jabber:client" to="localhost" version="1.0" xmlns:stream="http://etherx.jabber.org/streams" >

<stream:stream xmlns='jabber:client' xmlns:stream='http://etherx.jabber.org/streams' id='test' from='localhost' version='1.0' xml:lang='en'>

<auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='PLAIN'


<stream:stream xmlns='jabber:client' xmlns:stream='http://etherx.jabber.org/streams' to='localhost' version='1.0'>


PLAIN Auth
https://tools.ietf.org/html/rfc4616
https://stackoverflow.com/questions/57534916/response-decoding-failed-with-xmpp-sasl-authentication

Docker
https://github.com/processone/ejabberd/issues/2423


BOSH
https://xmpp.org/extensions/xep-0206.html

==== ADium ====
Received XML on stream = <<"<?xml version='1.0' ?><stream:stream to='localhost' xmlns='jabber:client' xmlns:stream='http://etherx.jabber.org/streams' version='1.0'>">>
Send XML on stream = <<"<?xml version='1.0'?><stream:stream id='15208853105445765565' version='1.0' xml:lang='en' xmlns:stream='http://etherx.jabber.org/streams' from='localhost' xmlns='jabber:client'>">>

Send XML on stream = <<"<stream:features><starttls xmlns='urn:ietf:params:xml:ns:xmpp-tls'><required/></starttls></stream:features>">>
Received XML on stream = <<"<starttls xmlns='urn:ietf:params:xml:ns:xmpp-tls'/>">>

Send XML on stream = <<"<proceed xmlns='urn:ietf:params:xml:ns:xmpp-tls'/>">>
Received XML on stream = <<"<stream:stream to='localhost' xmlns='jabber:client' xmlns:stream='http://etherx.jabber.org/streams' version='1.0'>">>

Send XML on stream = <<"<?xml version='1.0'?><stream:stream id='15216388251119256580' version='1.0' xml:lang='en' xmlns:stream='http://etherx.jabber.org/streams' from='localhost' xmlns='jabber:client'>">>

Send XML on stream = <<"<stream:features><mechanisms xmlns='urn:ietf:params:xml:ns:xmpp-sasl'><mechanism>DIGEST-MD5</mechanism><mechanism>PLAIN</mechanism><mechanism>SCRAM-SHA-1</mechanism><mechanism>X-OAUTH2</mechanism></mechanisms><register xmlns='http://jabber.org/features/iq-register'/></stream:features>">>
Received XML on stream = <<"<auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='DIGEST-MD5' xmlns:ga='http://www.google.com/talk/protocol/auth' ga:client-uses-full-bind-result='true'/>">>

Send XML on stream = <<"<challenge xmlns='urn:ietf:params:xml:ns:xmpp-sasl'>bm9uY2U9IjIyNzM0ODIzMjUzMDQ5NTY2NzIiLHFvcD0iYXV0aCIsY2hhcnNldD11dGYtOCxhbGdvcml0aG09bWQ1LXNlc3M=</challenge>">>
Received XML on stream = <<"<response xmlns='urn:ietf:params:xml:ns:xmpp-sasl'>dXNlcm5hbWU9InRlc3QiLHJlYWxtPSJsb2NhbGhvc3QiLG5vbmNlPSIyMjczNDgyMzI1MzA0OTU2NjcyIixjbm9uY2U9ImNiNjU2NTA1MTU3MzEwNjg3OTdkMjQ5ZTUxIixuYz0wMDAwMDAwMSxxb3A9YXV0aCxkaWdlc3QtdXJpPSJ4bXBwL2xvY2FsaG9zdCIscmVzcG9uc2U9NTBjYzY2MzBiYmUxOGYxOTE5MmNhZmUxNDdjMDFkNDAsY2hhcnNldD11dGYtOA==</response>">>
Send XML on stream = <<"<challenge xmlns='urn:ietf:params:xml:ns:xmpp-sasl'>cnNwYXV0aD03MjA5NzQyNzA2ZmVhNTZmMmFjMmFkOTgyNjVlMTAwOA==</challenge>">>
Received XML on stream = <<"<response xmlns='urn:ietf:params:xml:ns:xmpp-sasl'/>">>
Send XML on stream = <<"<success xmlns='urn:ietf:params:xml:ns:xmpp-sasl'/>">>
Received XML on stream = <<"<stream:stream to='localhost' xmlns='jabber:client' xmlns:stream='http://etherx.jabber.org/streams' version='1.0'>">>
Send XML on stream = <<"<?xml version='1.0'?><stream:stream id='5040283088484004806' version='1.0' xml:lang='en' xmlns:stream='http://etherx.jabber.org/streams' from='localhost' xmlns='jabber:client'>">>